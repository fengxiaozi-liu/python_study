#### Shell相关知识

##### 什么是shell文件

+ 后缀为`.sh`的文件就是shell脚本文件
+ shell中的第一行一般用#！来告诉系统其后路径所指定的程序是解析脚本文件Shell程序
  + #!/bin/bash
  + #!/bin/sh
  + #!/usr/bin/sh

##### 运行Shell脚本的两种方法

+ 作为可执行程序运行
  + chmod +x ./test.sh ---> 将test脚本文件变成可执行文件
  + ./test.sh 或sh ./test.sh来运行这个文件
+ 作为解释器参数
  + /bin/sh test.sh
  + 补充：如果作为解释器参数来运行脚本文件，不要在第一行指定解释信息，因为写了也没有用。

##### 变量

###### 变量的基本操作

+ 定义一个变量

  + ```shell 
    # 定义一个变量的时候=两边不能有空格
    val=1 
    ```

+ 使用一个变量

  + `$变量名`使用变量

  + `${变量名}`使用变量

  + ```shell 
    $a
    ${b}
    ```

+ 只读变量

  + readonly命令可以将变量定义为只读变量

+ 删除变量

  + unset命令可以删除变量

###### 变量类型

+ 局部变量
  + 局部变量在脚本或者命令中定义，尽在当前shell实例中有效，其他shell启动程序不能访问局部变量
+ 环境变量
  + 所有程序，包括shell启动程序，都可以范根环境变量，有些程序需要环境变量来保证运行的必要时，shell脚本也可以定义环境变量。
+ shell变量
  + shell变量是由shell程序设置的特殊变量。shell变量中有一部分是环境变量，一部分是局部变量，这些变量保证了程序的正常运行

###### shell中的引号

+ 单引号`''`
  + 单引号里面的任何字符都会原样输出，但引号字符串变量无效的。
  + 单引号字符串中不能出现单独一个引号，即使是使用了转义字符也不行
+ 双引号`""`
  + 双引号里面可以与变量
  + 双引号可以出现转义字符
+ 反引号``
  + 反引号里面的内容会转换成shell命令进行执行

###### shell中`$`符号

+ | 参数      | 作用                                                         |
  | --------- | ------------------------------------------------------------ |
  | $a/${a}   | 用来取出来变量a的值                                          |
  | $1 -- $n  | 表示1-第n个参数                                              |
  | $#        | 表示传递参数的个数                                           |
  | $?        | 表示命令执行的结果是否正确，<br />如果正确返回0<br />不正确返回别的数字 |
  | $(cmd)    | 表示执行一个命令                                             |
  | $(表达式) | 表示执行一个表达式                                           |

###### shell中的运算符

+ 算数运算符

  + | 运算符号 | 作用       | 具体使用                           |
    | -------- | ---------- | ---------------------------------- |
    | +        | 做加法运算 | `expr $a + $b `或者 `[ $a + $b]`   |
    | -        | 做减法运算 | `expr $a - $b `或者 `[ $a - $b]`   |
    | *        | 做乘法运算 | `expr $a \* $b `或者 `[ $a \* $b]` |
    | /        | 做除法运算 | `expr $a / $b `或者 `[ $a / $b]`   |
    | %        | 取余       | `expr $a % $b `或者 `[ $a % $b]`   |

+ 比较运算符

  + | 运算符号 | 作用                 | 具体使用                          |
    | -------- | -------------------- | --------------------------------- |
    | ==       | 检验两个值是否相等   | if [ $a == $b ]或if test $a == $b |
    | !=       | 检验两个值是否不相等 | if [ $a != $b ]或if test $a == $b |

  + 注意：

    + 比较运算符需要放在[]中括号里面进行比较或者使用test关键字
    + 变量与运算符之间有空格，变量还需要与中括号[]两边有空格

+ 关系运算符

  + 关系运算符合比较运算符比较相似，只是关系运算符只能运用于数字，还有是数字的字符串

  + | 参数 | 作用                             | 具体使用      |
    | ---- | -------------------------------- | ------------- |
    | -eq  | 检验两数是否相等                 | [ $a -eq $b ] |
    | -ne  | 检验两个值是否不相等             | [ $a -ne $b ] |
    | -gt  | 检验左边的数是否比右边的数大     | [ $a -gt $b ] |
    | -lt  | 检验左边的数是否比右边的数小     | [ $a -lt $b ] |
    | -ge  | 检验左边的数是否大于等于右边的数 | [ $a -ge $b ] |
    | -le  | 检验左边的数是否小于等于右边的数 | [ $a -le $b ] |

  + 注意：关系运算符合比较运算符的规定一样

+ 布尔运算符

  + | 参数 | 作用   |
    | ---- | ------ |
    | ！   | 不等于 |
    | -a   | 与运算 |
    | -o   | 或运算 |

+ 逻辑运算符

  + | 参数 | 作用       |
    | ---- | ---------- |
    | &&   | 逻辑与运算 |
    | \|\| | 逻辑或运算 |

+ 字符串运算符

  + | 参数 | 作用                               | 具体使用     |
    | ---- | ---------------------------------- | ------------ |
    | =    | 检验两个字符串是否相等             | [ $a = $b ]  |
    | !=   | 检验两个字符串是否不相等           | [ $a != $b ] |
    | -z   | 检验字符串是否为空，若为空返回true | [ -z $a ]    |
    | -n   | 检验字符串是否为空，不为空返回true | [-n $a]      |
    | $    | 检测字符串是否为空，不为空返回true | [ $a ]       |

+ 文件测试运算符

  + | 参数    | 作用                               | 具体使用    |
    | ------- | ---------------------------------- | ----------- |
    | -b file | 检测文件是否是块文件               | [ -b file ] |
    | -c file | 检测文件是否是字符设备文件         | [ -c file ] |
    | -d file | 检测文件是否是目录                 | [ -d file ] |
    | -f file | 检测文件是否是普通文件             | [ -f file ] |
    | -g file | 检测文件是否设置了SGID定位         | [ -g file ] |
    | -k file | 检测文件是否设置粘着位             | [ -k file ] |
    | -u file | 检测文件是否设置了SUID定位         | [ -u file ] |
    | -r file | 检测文件是否是可读文件             | [ -r file ] |
    | -w file | 检测文件是否是可写文件             | [ -w file ] |
    | -x file | 检测文件是否是可执行文件           | [ -x file ] |
    | -e file | 检测文件是是否存在                 | [ -e file ] |
    | -s file | 检测文件是否为空                   | [ -s file ] |
    | -S file | 检测文件是否是socket               | [ -S file ] |
    | -L file | 检测文件是否存在并且是一个符号链接 | [ -L file ] |

###### shell中的字符串

+ 字符串是shell编程中最常用的数据类型
+ 获取字符串的长度
  + `${#变量名}`
+ 提取子字符串
  + `${变量名:start:end}` 获取从start到end位置中的字符
+ 查找子字符串
  + `expr index $变量名 要查找的字母`

###### shell中的数组

+ 数组可以存放多个值，Bash Shell只可以支持一维数组，初始化时不需要定义数组的大小
+ 定义数组
  + 第一种方式
    + array_name=(v1 v2 v3)
  + 第二种方式
    + array_name[0]=v1
+ 读取数组中的元素
  + ${array_name[index]}读取数组中指定的元素
  + ${array_name[@]}读取数组中的所有元素
+ 读取数组中的长度
  + ${#array_name[@]}
  + ${#array_name[*]}

###### shell中的传参

+ $0 表示要执行的文件
+ $1 - $n 表示要传递的参数
+ $*或$@表示传递参数的个数

shell中的流程控制

+ 条件判断

  + ```shell
    # if....else fi 语句
    if condition
    then
    	command
    	...
    fi
    # if...elif...else...fi语句
    if condition
    then
    	command
    	....
    elif condition
    then
    	command
    	...
    else
    	command
    	...
    fi
    
    ```

+ 循环语句

  + ```shell 
    # for循环（第一种形式）
    for 变量 in v1 v2 v3 ...
    do
    	command
    	...
    done
    # for循环（第二种形式）
    for((i=0,i<5,i++))
    do
    	command
    	...
    done
    
    # while 循环
    while condition
    do
    	command
    	....
    done
    
    # until循环
    :<<EOF
    until循环与while循环差不多，只是until循环实当条件为真时，结束循环
    EOF
    ```

+ case语句

  + shell中的case语句是多选择语句，可以用case语句匹配一个值或者是一个模式

  + ```shell 
    case value in
    模式1)
    	command
    	...
    	,,
    模式2)
    	command
    	...
    	,,
    模式3)
    	command
    	...
    	,,
    esac
    ```

###### shell命令中的输入和输出重定向

+ 需要注意的是0是标准的输入，1是标准的输出，2是错误输出
+ command > file 
  + 命令输出的结果保存到file
  + 这种输出会覆盖掉原来输出的内容
+ command >> file
  + 命令以追加的形式保存到file文件中
  + 原来输出的内容不会被覆盖
+ command 1 > file
  + 命令的结果，运行正确会被保存到file文件中
+ command 2> file 
  + 命令结果的错误输出会被保存到file文件中哪个
+ command 1>> file 
  + 命令结果的正确输出会追加到file文件中
+ command 2>> file 命令结果的错误输出会追加到file文件中

###### shell中的文件包含

+ 和其他语言一样，shell也可以包含外部脚本。

+ 这样就可以很方便的封装一些公用的代码来形成一个独立的文件

+ 调用shell文件

  + ```shell 
    . 文件路径
    ```

  + ```shell 
    source 文件路径
    ```

    

